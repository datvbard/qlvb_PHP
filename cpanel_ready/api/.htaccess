# ===================================
# URL REWRITING FOR API
# ===================================

RewriteEngine On

# PHP Handler - Ensure PHP files are processed
<IfModule mime_module>
    AddHandler application/x-httpd-php .php
</IfModule>

# Enable CORS
Header always set Access-Control-Allow-Origin "*"
Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
Header always set Access-Control-Allow-Headers "Content-Type, Authorization"

# Handle OPTIONS requests
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ $1 [R=200,L]

# Route /api/auth/* to auth.php
RewriteRule ^auth/(.*)$ auth.php/$1 [L,QSA]

# Route /api/categories/* to categories.php
RewriteRule ^categories/(.*)$ categories.php/$1 [L,QSA]
RewriteRule ^categories$ categories.php [L,QSA]

# Route /api/menu-items/* to menu.php
RewriteRule ^menu-items/(.*)$ menu.php/$1 [L,QSA]
RewriteRule ^menu-items$ menu.php [L,QSA]

# Route /api/documents/* to documents.php
RewriteRule ^documents/([^/]+)/upload$ upload.php/$1 [L,QSA]
RewriteRule ^documents/([^/]+)/files$ upload.php/$1 [L,QSA]
RewriteRule ^documents/(.*)$ documents.php/$1 [L,QSA]
RewriteRule ^documents$ documents.php [L,QSA]

# Route /api/files/* to files.php
RewriteRule ^files/(.*)$ files.php/$1 [L,QSA]
